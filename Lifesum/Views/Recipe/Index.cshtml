@model Lifesum.Models.CascadingClass

@{

    Layout = "~/Views/Shared/_Layout.cshtml";
    ViewData["Title"] = "Home Page";
}

@*<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/4.3.1/flatly/bootstrap.min.css">*@
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" integrity="sha512-KfkfwYDsLkIlwQp6LFnl8zNdLGxu9YAA1QvwINks4PhcElQSvqcyVLLD9aMhXd13uQjoXtEKNosOWaZqXgel0g==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />


<style type="text/css">
    .multiselect-container {
        width: 100% !important;
        height: 120px !important;
        overflow-y: auto;
    }

    .search_bar {
        width: 100%;
        /*        margin: 50px auto;
    */
    }
    /*.search_bar_margin
        {
            margin-top: -20px;
        }*/
    /* Bootstrap 4 text input with search icon */
    .has-search .form-control {
        padding-left: 2.375rem;
    }

    .has-search .form-control-feedback {
        position: absolute;
        z-index: 2;
        display: block;
        width: 2.375rem;
        height: 2.375rem;
        line-height: 2.375rem;
        text-align: center;
        pointer-events: none;
        color: #aaa;
    }
</style>

@if (TempData["Msg"] != null)
{
    <div class="alert alert-cyan alert-dismissable" data-auto-dismiss role="alert">
        <h5 style="color: #4E9F3D; margin-bottom: 10px; font-size: 25px;">
            @TempData["Msg"]
        </h5>
    </div>
}


<div class="card mb-4">
    <div class="card-body">
        <h5 class="mb-4">Add Recipe</h5>
        <form action="AddRecipe" method="post" enctype="multipart/form-data" class="needs-validation tooltip-label-right">

            <div class="form-group position-relative error-l-50">
                <label>Title</label>
                <input type="text" name="title" class="form-control" required>
                <div class="invalid-tooltip">
                    Title is required!
                </div>
            </div>

            <div class="form-group position-relative error-l-50">
                <label>No of Servings</label>
                <input type="number" step="any" name="servings" class="form-control" required>
                <div class="invalid-tooltip">
                    Servings are required!
                </div>
            </div>

            <div class="form-group position-relative error-l-50">
                <label>Image</label>
                <input type="file" name="image" accept="image/*" class="form-control" required>
                <div class="invalid-tooltip">
                    Image is required!
                </div>
            </div>

            <div class="form-group position-relative error-l-50">
                <label>Instructions</label>
                @*<select multiple name="instructions" class="form-control" data-role="tagsinput" required>
                <option />
            </select>*@
                <select class="js-example-tags form-control" name="instructions" multiple="multiple" style="width: 100%" required>
                </select>
                <div class="invalid-tooltip">
                    Instructions are Required!
                </div>
            </div>

            <div class="form-group position-relative error-l-50">
                <label>Preparing Time</label>
                <input type="number" name="preparingTime" class="form-control" required>
                <div class="invalid-tooltip">
                    Preparing Time is Required!
                </div>
            </div>

            @*<div class="form-group position-relative error-l-50">
            <label>Add Food</label>
            <select asp-for="FoodId" name="addFood" multiple="multiple" class="form-control" asp-items="@(new SelectList(ViewBag.Food, "FoodId", "title"))">
                <option>Select Food</option>
            </select>
            <select id="example-getting-started" name="addFood" multiple="multiple" class="nice_Select wide mb_30 multiselect-container form-control" required>

                @foreach (var item in ViewBag.Food)
                {
                    <option value="@item.FoodId">@item.title</option>
                }

            </select>
            <div class="invalid-tooltip">
                Food is required!
            </div>
        </div>*@


            <div class="form-group position-relative error-l-50">
                <label>Filters</label>
                <select id="example-getting-started" name="filter" multiple="multiple" class="nice_Select wide mb_30 multiselect-container form-control scroll" required>
                    @*<option disabled selected value="">Select Filter</option>*@
                    @if (ViewBag.Filter != null)
                    {
                        foreach (var item in ViewBag.Filter)
                        {
                            foreach (var items in item.filters)
                            {
                                <option value="@items">@items</option>
                            }
                        }
                    }
                </select>
                <div class="invalid-tooltip">
                    Filter is required!
                </div>
            </div>


            <div class="form-group position-relative error-l-50">
                <label>Type</label>
                <select class="form-control" name="type" aria-label="Default select example" required>
                    <option disabled selected value="">Select Type</option>
                    <option value="Breakfast">Breakfast</option>
                    <option value="Lunch">Lunch</option>
                    <option value="Snack">Snack</option>
                    <option value="Dinner">Dinner</option>
                </select>
                <div class="invalid-tooltip">
                    Type is required!
                </div>
            </div>

            @*<div class="form-group position-relative error-l-50">
            <label>Food</label>
            <select asp-for="FoodId" class="form-control" asp-items="@(new SelectList(ViewBag.Food, "FoodId", "title"))" required>
                <option disabled selected value="">Select Food</option>
            </select>

            <div class="invalid-tooltip">
                Food is required!
            </div>
        </div>*@

            <div class="form-group position-relative error-l-50">
                <label>Manual Ingredients</label>
                @*<select multiple name="instructions" class="form-control" data-role="tagsinput" required>
                <option />
            </select>*@
                <select class="js-example-tags form-control" name="manualIngredients" multiple="multiple" style="width: 100%" required>
                </select>
                <div class="invalid-tooltip">
                    Manual Ingredients are Required!
                </div>
            </div>

            <div class="search_bar">
                <label>Food Search</label>
                <div class="input-group position-relative error-l-50">
                    <input type="text" class="form-control" placeholder="Food Search" id="foodId" name="search" required>
                    <div class="input-group-append">
                        <button class="btn btn-secondary" type="button" id="SubmitFoodSearch">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>
                    <div class="invalid-tooltip">
                        Food is required!
                    </div>
                </div>
            </div>

            <div class="form-group position-relative error-l-50" id="result" style="margin-top: 15px;">
                @*<select asp-for="FoodId" class="form-control" asp-items="@(new SelectList(ViewBag.Food, "FoodId", "title"))" required>
                <option disabled selected value="">Select Food</option>
            </select>*@

                <div class="invalid-tooltip">
                    Food is required!
                </div>
            </div>

            <div class="form-group position-relative error-l-50" id="Serving" style="margin-top: 15px;">
                @*<select asp-for="FoodId" class="form-control" asp-items="@(new SelectList(ViewBag.Food, "FoodId", "title"))" required>
                <option disabled selected value="">Select Food</option>
            </select>*@

                <div class="invalid-tooltip">
                    Serving is required!
                </div>
            </div>

            @*<div class="form-group position-relative error-l-50">
            <label>Serving</label>
            <select asp-for="SerId" name="serving" class="form-control" asp-items="@(new SelectList(""))" required>
                <option disabled selected value="">Select Serving</option>
            </select>
            <div class="invalid-tooltip">
                Serving is required!
            </div>
        </div>*@

            <button type="submit" class="btn btn-primary mb-0" style="background-color: #6fb327; border-color: #6fb327">Save</button>

        </form>
        <button id="add" class="btn btn-primary mb-0" style="float: right; margin-right: 72%; margin-top: -37px; background-color: #6fb327; border-color: #6fb327">Add Food to Recipe</button>

    </div>
</div>

@*Search Modal*@
@*<button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal">Open Modal</button>*@

@*<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Food Search</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="search_bar_margin">
                            <div class="input-group">
                                <input type="text" class="form-control" id="foodId" name="search" placeholder="Food Search">
                                <div class="input-group-append">
                                    <button class="btn btn-secondary" type="button" id="SubmitFoodSearch">
                                        <i class="fa fa-search"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </form>

                    <div id="result">

                    </div>

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary">Add Food</button>
                </div>
            </div>
        </div>
    </div>*@


<div id="GetCalculation">

</div>


<script src="~/js/jquery-3.3.1.min.js"></script>
@*<script src="https://platform.fatsecret.com/js?key=eef0b4de26264a279cfdda9f0d2f7caf&theme=green&auto_load=true"></script>*@
@*<script src="https://platform.fatsecret.com/js?key=eef0b4de26264a279cfdda9f0d2f7caf&auto_load=true&theme=green"></script>*@

<script>
    //$(document).ready(function () {
    //    debugger
    //    $("#FoodId").change(function () {
    //        var Id = $(this).val();
    //        debugger
    //        $.ajax({
    //            type: "post",
    //            url: "/Recipe/GetFoodById?id=" + Id,
    //            contentType: "html",
    //            success: function (response) {
    //                debugger
    //                $("#SerId").empty();
    //                $("#SerId").append(response);

    //            }
    //        })
    //    });
    //});

    $(function () {
        $("#add").click(function () {
            var food = $('#FoodId').val();
            var serving = $('#SerId').val();
            debugger
            $.ajax({
                type: 'post',
                url: '@Url.Action("AddtoRecipe", "Recipe")',
                data: { 'food': food, 'serving': serving },
                contenttype: 'application/json; charset=utf-8',
                async: true,
                success: function (response) {
                    debugger
                    $("#GetCalculation").empty();
                    $("#GetCalculation").append(response);

                }
                })
                });
    });

    $(function () {
        $("#SubmitFoodSearch").click(function () {
            var foodName = $('#foodId').val();

            debugger
            $.ajax({
                type: 'post',
                url: '@Url.Action("DisplaySearchFood", "Recipe")',
                data: { 'foodName': foodName },
                contenttype: 'application/json; charset=utf-8',
                async: true,
                success: function (response) {
                    debugger
                    $("#result").empty();
                    $("#result").append(response);

                }
                })
                });
    });



    setTimeout(function () {
        $(".alert").fadeTo(500, 0).slideUp(500, function () {
            $(this).remove();
        });
    }, 4000);

    var expanded = false;

    function showCheckboxes() {
        var checkboxes = document.getElementById("checkboxes");
        if (!expanded) {
            checkboxes.style.display = "block";
            expanded = true;
        } else {
            checkboxes.style.display = "none";
            expanded = false;
        }
    }

</script>

@*<script src="https://code.jquery.com/jquery-2.2.4.js" integrity="sha256-iT6Q9iMJYuQiMWNd9lDyBUStIq/8PuOW33aOqmvFpqI=" crossorigin="anonymous"></script>*@
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
<script>
    $(".js-example-tags").select2({
        tags: true
    });
</script>


@*<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>*@
@*<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>*@
@*<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>*@
@*<script src="https://cdnjs.cloudflare.com/ajax/libs/typeahead.js/0.11.1/typeahead.bundle.min.js"></script>*@


